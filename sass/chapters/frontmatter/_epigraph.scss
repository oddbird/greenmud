// ----------------------------------------------------------------------------
// settings

$bg               : color($darkest);

$fg-angle         : 320deg;
$fg-color         : color($off $blue $hint);
$fg-details       : color($fg-color,0),
                    color($fg-color,0) 50%,
                    color($fg-color,.9) 50%,
                    color($fg-color,.9);
$fg-old           : linear-gradient($fg-angle, $fg-details...);
$fg-new           : fix-linear($fg-angle, $fg-details...);

$pg               : '#{$ch}epigraph/';
$lightning        : image-url('#{$pg}lightning.png') no-repeat scroll rhythm(-99) rhythm(-99);
$angle            : image-url('#{$pg}angle.svg') no-repeat center;
$default-pos      : top left;

$lightning-color  : color($slight $blue $darker);

// ----------------------------------------------------------------------------
// animations

$lightning-pos1   : center rhythm(-8);
$lightning-pos2   : rhythm(1) rhythm(-1);
$lightning-pos3   : rhythm(12) rhythm(-5);
$lightning-pos4   : rhythm(-3) rhythm(-3);

@include keyframes(lightning) {

  0%, 56%, 100% {
    background-position: $default-pos, $default-pos, rhythm(-99) rhythm(-99);
    background-color: $bg;
  }
  48%, 52%, 54% {
    background-position: $default-pos, $default-pos, $lightning-pos1;
    background-color: $lightning-color;
  }
  49%, 53% {
    background-position: $default-pos, $default-pos, $lightning-pos3;
    background-color: $bg;
  }
  50% {
    background-position: $default-pos, $default-pos, $lightning-pos4;
    background-color: $lightning-color;
  }
  51% {
    background-position: $default-pos, $default-pos, $lightning-pos2;
    background-color: $bg;
  }
}

/* ----------------------------------------------------------------------------
   epigraph: cocorosie */

#epigraph {
  @include page-animation(lightning 10s steps(1,end) infinite both);
  @include text-shadow($bg 0 1px 0);
  @include background($lightning $bg);
  @include background($noise-layer, $fg-old, $lightning, $bg);
  background: $noise-layer, $fg-new, $lightning, $bg;

  .no-cssgradients & {
    @include background($noise-layer, $angle, $lightning, $bg);
    @include background-size(auto, cover, auto, auto);
  }

  // --------------------------------------------------------------------------
  // elements

  blockquote {
    @include adjust-font-size-to($smallpx);
    padding: rhythm(1.5) rhythm(1);
    color: color($light);
  }
  p { @include trailer; }

}
