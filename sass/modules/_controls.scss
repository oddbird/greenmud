/* ----------------------------------------------------------------------------
  controls */

$total-columns: 8;

$control-icon: $medpx;
$control-line: 1.5;

$control-text-color   : $mid;
$control-link-color   : $lightest;
$control-focus-color  : $white;

%control-icon {
  @extend %icon-replace;
  width: rhythm($control-line);
  &:before {
    @include adjust-font-size-to($control-icon,$control-line);
    right: 0;
    text-align: center;
  }
}

%control-link {
  #{$link} { color: $control-link-color; }
  #{$focus} { color: $control-text-color; }
  &[href] { 
    #{$focus} { color: $control-focus-color; }
  }
}

// ----------------------------------------------------------------------------
// toggle

#toggle {
  @extend %control-icon;
  @extend %icon-cog;
  @include text-shadow(rgba($darkest,$small) 0 0 3px);
  @include adjust-leading-to($control-line);
  position: absolute;
  top: 0;
  right: 0;
  color: $control-focus-color;
  cursor: pointer;
  z-index: 950;
  #{$focus} { 
    @include text-shadow($darkest 0 0 3px);
  }
}

// ----------------------------------------------------------------------------
// controls

.controls {
  @include clearfix;
  @include stretch-x;
  @include adjust-leading-to($control-line);
  @include text-shadow(rgba($darkest,$small) 0 1px 0);
  padding: 0 rhythm($control-line) 0 $grid-padding;
  min-width: rhythm($control-line*4);
  background: $darker;
  color: $control-text-color;
  z-index: 900;
  a { @extend %control-link; }

  // toggle controls ------//
  display: none;
  &.active, .showcontrols & { display: block; }
}

// ----------------------------------------------------------------------------
// meta

.meta {
  @include horizontal-list(0);
  float: left;
  width: rhythm($control-line*2);
  a {
    #{$link} {
      @extend %control-icon;
      float: left;
      width: rhythm($control-line);
    }
  }
}

[rel="contents"] { @extend %icon-list; }
[rel="home"] { @extend %icon-home; }

// ----------------------------------------------------------------------------
// breadcrumb

$breadcrumb-font-size: $smallpx;
$breadcrumb-break: 50em;

.breadcrumb { 
  @extend %ellipsis;
  @include clearfix;
  @include adjust-font-size-to($breadcrumb-font-size,$control-line);
  max-height: rhythm($control-line,$breadcrumb-font-size);
  text-align: center;
  width: auto;
  li { 
    display: inline;
    &:after { content: ":"; }
    &:last-child { &:after { content: ""; } }
  }
  @include media($breadcrumb-break) { 
    @include adjust-font-size-to($base-font-size,$control-line);
    max-height: rhythm($control-line);
    text-align: left;
  }
}

// ----------------------------------------------------------------------------
// pagenav

.pagenav { 
  float: right;
  width: rhythm($control-line*2);
  a { display: block; }
}
.prev { float: left; }
.next { float: right; }

[rel="prev"] {
  @extend %control-icon;
  @extend %icon-arrow-left;
}

[rel="next"] {
  @extend %control-icon;
  @extend %icon-arrow-right;
}

// ----------------------------------------------------------------------------
// table of contents

#toc {
  @include clearfix;
  background: $darkest;
  color: $control-text-color;
  a { @extend %control-link; }
  ol { 
    list-style-type: decimal-leading-zero; 
    list-style-position: inside;
  }
  li { @extend %ellipsis; }
  .wrap { 
    @include container; 
    @include padding-leader($control-line+.5);
    @include media($breadcrumb-break) { margin-left: rhythm($control-line*2); }
  }

  // show and hide toc
  @include transition(max-height 600ms);
  height: 0;
  max-height: 0;
  &.active { 
    height: auto;
    max-height: 45em; 
  }
}

[class^="toc-"] { 
  @include trailer;
  @include media(32em) {
    @include span-columns(4,$total-columns); 
    &:last-child { @include omega; }
  }
}
