// ----------------------------------------------------------------------------
// settings

$total-columns  : 3;
$original-col   : $column-width;
$column-width   : $column-width +.5;

$grass-location : rhythm(15);
$half-border    : (2px / $base-font-size)/2;
$grass-color    : $off-yellow-lighter;
$grass-dark     : $off-green;
$bg-angle       : top;
$bg-details     : rgba($grass-color,0),
                  rgba($grass-color,0) $grass-location - $half-border,
                  rgba($black,0) $grass-location - $half-border,
                  rgba($black,1) $grass-location + $half-border,
                  rgba($grass-color,1) $grass-location + $half-border,
                  rgba($grass-color,1) $grass-location + rhythm(2),
                  rgba($grass-dark,1) $grass-location * 3;
$bg-old         : linear-gradient($bg-angle, $bg-details...);
$bg-new         : fix-linear($bg-angle, $bg-details...);

$pg             : '#{$ch}johnny-john-goes-sitting-on-a/';
$swing          : 'frontmatter/home/swing.png';
$sunburst       : '#{$pg}sunburst.png';
$treetrunk      : '#{$pg}treetrunk.png';
$rainish        : '#{$pg}rainish.png';

$tree-hide      : -30em 0em;
$tree-pos       : 0em 0em;
$sunburst-pos   : top right;
$rainish-pos    : rhythm(-4) rhythm(1);
$rainish-pos1   : rhythm(-3) rhythm(2);
$rainish-pos2   : rhythm(-2) rhythm(1);
$rainish-pos3   : rhythm(-4) rhythm(3);

$swing-layer    : image-url($swing) no-repeat scroll 0 rhythm(-3.25);
$sunburst-layer : image-url($sunburst) no-repeat scroll $sunburst-pos;
$treetrunk-layer: image-url($treetrunk) no-repeat scroll $tree-hide;
$rainish-layer  : image-url($rainish) no-repeat scroll rhythm(-6) rhythm(8);

// ----------------------------------------------------------------------------
// animation

@include keyframes(rainish) {
  0%, 50%, 65%, 100% { background-position: 0, $tree-pos, 0, $rainish-pos1, $rainish-pos, $sunburst-pos; }
  55% { background-position: 0, $tree-pos, 0, $rainish-pos2, $rainish-pos, $sunburst-pos; }
  60% { background-position: 0, $tree-pos, 0, $rainish-pos3, $rainish-pos, $sunburst-pos; }
}

// ----------------------------------------------------------------------------
// johnny-john-goes-sitting-on-a

#johnny-john-goes-sitting-on-a {
  @include transition(background 1s);
  @include background($noise-layer, $treetrunk-layer, $bg-old, $rainish-layer, $sunburst-layer);
  background: $noise-layer, $treetrunk-layer, $bg-new, $rainish-layer, $rainish-layer, $sunburst-layer;

  @include at-breakpoint(columns-width(6) $total-columns) {
    @include animation(rainish 10s infinite both);
    background-position: 0, $tree-pos, 0, $rainish-pos1, $rainish-pos, $sunburst-pos;
  }

  [role="main"] {
    @extend %transition-main;
    @include container;
    @include rhythm-padding(3,4);
    @include background($swing-layer);
  }

  i {
    @include trailer;
    display: block;
    margin-left: - space(2);
    font-weight: bold;
  }

  p {
    @extend %transition;
    @include prefix(2);
    text-align: right;
  }
}

$column-width: $original-col;
